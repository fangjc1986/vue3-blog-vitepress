var b=Object.defineProperty;var u=(s,i,a)=>i in s?b(s,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[i]=a;var p=(s,i,a)=>u(s,typeof i!="symbol"?i+"":i,a);import{_ as r}from"./chunks/lodash.aK6H4lhT.js";import{a0 as o,n as h,k as l,m as E,p as m,F as d,Q as g,q as B,h as D,R as c,t as y,l as A}from"./chunks/framework.BULi5HC7.js";import"./chunks/theme.HcMMCyBp.js";class f{constructor(i,a){p(this,"row",0);p(this,"column",0);p(this,"type",0);this.row=i,this.column=a}}const F=[[-1,0,1,0],[0,1,0,-1]],_={name:"SnakeGame",data(){return{area:[20,40],grids:[],snakeLength:3,snake:[],nowDir:1,runTmo:null,status:0}},mounted(){this.init(),window.addEventListener("keydown",this.keyDownEvent)},beforeDestroy(){window.removeEventListener("keydown",this.keyDownEvent)},methods:{restart(){clearTimeout(this.runTmo),this.init(),this.status=1,this.runTmo=setTimeout(this.snakeRun.bind(this),500)},init(){for(let s=0;s<this.area[0];s++){this.grids[s]=[];for(let i=0;i<this.area[1];i++)this.grids[s][i]=new f(s,i)}this.snake=this.grids[0].slice(0,3).reverse().map(s=>(s.type=2,s)),this.addFood(),this.$forceUpdate()},snakeRun(){const s=this.snake[0],i=(s.row+F[0][this.nowDir]+this.area[0])%this.area[0],a=(s.column+F[1][this.nowDir]+this.area[1])%this.area[1];if(i>=this.area[0]||i<0||a>=this.area[1]||a<0)return this.gameOver();const n=this.grids[i][a];if([0,1].includes(n.type)||!this.snake.slice(1).includes(n)){this.snake.unshift(n);const k=n.type===1;[0,2].includes(n.type)&&(this.snake.pop().type=0),n.type=2,k&&this.addFood()}else return this.gameOver();this.$forceUpdate(),this.runTmo=setTimeout(this.snakeRun.bind(this),500*.9**(this.snake.length/3))},addFood(){const s=r.difference(r.flatten(this.grids),this.snake),i=s[Math.floor(s.length*Math.random())];i.type=1},keyDownEvent(s){if(!this.status||s.keyCode>40||s.keyCode<37)return;s.preventDefault();const i=(s.keyCode-34)%4;(i+2)%4!==this.nowDir&&(this.nowDir=i,clearTimeout(this.runTmo),this.snakeRun())},gameOver(){this.status=0,clearTimeout(this.runTmo)},gridStyle(s){return{"background-color":this.snake[0]===s?"blue":["#f2f2f2","#ff00ff","#000"][s.type]}}}},v={class:"SnakeGame"},q={class:"flex-horiz"},w={class:"pa-xs pos-r",style:{border:"1px solid #eeeeee"}},x={key:0,class:"pos-a",style:{top:"100px",left:"0",right:"0"}},T={class:"flex-horiz rows",style:{}};function S(s,i,a,n,k,t){return l(),h("div",v,[E("div",q,[E("div",w,[k.status?m("",!0):(l(),h("div",x,[E("div",{class:"pa-sm restart-button",onClick:i[0]||(i[0]=(...e)=>t.restart&&t.restart(...e))},"点击重新开始")])),(l(!0),h(d,null,g(k.grids,e=>(l(),h("div",T,[(l(!0),h(d,null,g(e,C=>(l(),h("div",{class:"grid",style:B(t.gridStyle(C))},null,4))),256))]))),256))])])])}const G=o(_,[["render",S],["__scopeId","data-v-f5d4c8cd"]]),R=c("",4),O=c("",4),z=JSON.parse('{"title":"贪吃蛇","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/snake.md","filePath":"games/snake.md"}'),P={name:"games/snake.md"},I=Object.assign(P,{setup(s){return(i,a)=>{const n=D("ClientOnly");return l(),h("div",null,[R,y(n,null,{default:A(()=>[y(G)]),_:1}),O])}}});export{z as __pageData,I as default};
