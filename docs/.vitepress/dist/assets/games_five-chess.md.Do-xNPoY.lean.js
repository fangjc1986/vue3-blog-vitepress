import{M as W}from"./chunks/ai.util.BN6OXwDL.js";import{l as b}from"./chunks/lodash.B4c3keQ2.js";import{S as G}from"./chunks/start-over-mask.CktQDDxI.js";import{e as O,r as B,a0 as N,j as x,k as d,p as g,n as c,F as o,P as D,u as q,s as _,v as S,m as w,Q as R}from"./chunks/framework.DXL0bVlL.js";import"./chunks/theme.DXIttjq3.js";const m=()=>new Array(e).fill("").map(s=>new Array(e).fill(E)),V=O({name:"five-chess",components:{StartOverMask:G},props:{},setup(s,k){const a=B(new f(m(),[])),i=B(1),n=B(new f(m(),[])),h=B(!1),l=new W(2).setEvaluateResult(K).setIsLeafState(Q).setNextLevelState(Z),p=()=>{if(i.value!=2||!h.value)return;const t=l.getBestChoiceByState(b.cloneDeep(a.value));t&&(n.value=b.cloneDeep(a.value),a.value=t,y(),h.value=!1)},y=()=>{const t=j(a.value);t!==E&&(i.value=t===1?3:4);for(const r of a.value.state)for(const F of r)if(F===E)return;i.value=5};return{W:u,B:A,EMPTY:E,RC:e,isAiComputing:h,gameState:i,lastState:n,chessState:a,onClickChess:(t,r)=>{const{state:F,trace:I}=a.value;i.value===2&&(h.value||F[t][r]!==E||(h.value=!0,n.value=b.cloneDeep(a.value),F[t][r]=u,I.push([t,r]),y(),setTimeout(p,10)))},onClickRestart:()=>{a.value=new f(m(),[]),n.value=new f(m(),[]),i.value=2,h.value=!1}}}});class f{constructor(k,a=[],i=!0){this.state=k,this.trace=a}}const $=[[11111,1e5,1e4],[211112,1e6,1e3],[11112,1e5,100],[12111,1e5,100],[11211,1e5,100],[211212,1e6,100],[21112,1e5,100],[21111,1e5,100],[11121,1e5,100],[212112,1e6,100],[11122,1e5,10],[22111,1e5,10],[22111,1e5,10],[11122,1e5,10],[11212,1e5,4],[21211,1e5,4],[22112,1e5,1],[21122,1e5,1]],u=1,A=3,E=2,e=15,T=[],M=[],P=[],Y=[];for(let s=0;s<e;s++){const k=[],a=[];for(let i=0;i<e;i++)k.push([i,s]),a.push([s,i]);T.push(a),M.push(k)}for(let s=-e+1;s<e;s++){const k=[],a=[];for(let i=0;i<e;i++){const n=s+i;n<0||n>=e||(k.push([i,n]),a.push([e-i-1,n]))}P.push(k),Y.push(a)}const J=(s,k)=>[T[s],M[k],P[k-s+e-1],Y[s+k]],Q=s=>j(s)!==E,j=({state:s})=>{const k=is(s);let a=!0;for(const i of k){if(i.length<5)continue;let n=0,h=0;for(const[l,p]of i){if(s[l][p]===A?(h++,n=0):s[l][p]==u?(n++,h=0):n=h=0,s[l][p]===E&&a!==E&&(a=E),h===5)return A;if(n===5)return u}}return a},L=[],v=6;for(let s=0;s<=v*2;s++)L[s]=10**s;const H=[[0,1],[1,0],[1,1],[1,-1]],K=(s,k)=>{const{state:a,trace:i}=s;new Array(e).fill(!0).map(h=>new Array(e).fill(0));let n=0;return i.forEach(h=>{const[l,p]=h,y=a[l][p],t=[];H.forEach(r=>{const F=U(X(a,r,h,y),k,y);n+=F,F&&t.push(F)}),t.sort();for(let r=0;r<t.length-1;r++)n+=t[r]}),n},U=(s,k,a)=>{let i=0;for(const[n,h,l]of $){let p=s;for(;p!=0;)p-n===Math.floor(p/h)*h&&(i+=l),p=Math.floor(p/10);if(i!==0)break}return a===A?i:-i},X=(s,k,a,i)=>{let n=0,[h,l]=a;for(let p=-v;p<=v;p++){const[y,t]=[h+k[0]*p,l+k[1]*p],r=L[v-p];C(y,t)&&(s[y][t]===i?n+=r:s[y][t]===E&&(n+=2*r))}return n},Z=function*(s,k){const{state:a,trace:i}=k;let n=[];z(a,h=>h!==E).forEach(h=>{ss(a,h[0],h[1]).forEach(l=>{a[l[0]][l[1]]===E&&n.push(l[0]*e+l[1])})}),n=b.shuffle(b.uniq(n)).map(h=>[Math.floor(h/e),h%e]);for(const[h,l]of n)a[h][l]=s?A:u,i.push([h,l]),yield k,a[h][l]=E,i.pop([h,l]),yield k},ss=(s,k,a,i=2)=>{const n=[];for(let h=-i;h<=i;h++){let l=h+k,p=a;C(l,p)&&s[l][p]===E&&n.push([l,p]),l=k,p=a+h,C(l,p)&&s[l][p]===E&&n.push([l,p]),l=k+h,p=a+h,C(l,p)&&s[l][p]===E&&n.push([l,p]),l=k+h,p=a-h,C(l,p)&&s[l][p]===E&&n.push([l,p])}return n},C=(s,k)=>s>=0&&s<e&&k>=0&&k<e,z=(s,k)=>{if(!s)throw Error(s);const a=[];for(let i=0;i<e;i++)for(let n=0;n<e;n++)(k?!!k(s[i][n],i,n):!1)&&a.push([i,n]);return a},is=s=>{const k=z(s,i=>i!==E),a=new Set;return k.forEach(i=>{J(i[0],i[1]).forEach(n=>a.add(n))}),[...a]},as={class:"five-chess vue-component-container"},ns={class:"flex-column flex-center-all"},hs={class:"text-center mb-sm pos-r"},ks={key:0,class:""},ls={key:1,class:""},ps={key:2,class:""},ts={class:"pos-r"},es={class:"chess-container-b",style:{"z-index":"0"}},Es={class:"flex-horiz row-b"},rs={class:"flex-horiz grid-b"},ds={class:"pos-a chess-container",style:{"z-index":"10"}},gs={class:"flex-horiz row"},ys=["onClick"],Fs={class:"mb-sm",style:{"font-size":"30px"}},cs={key:0},Cs={key:1},bs={key:2};function us(s,k,a,i,n,h){const l=x("start-over-mask");return d(),g("div",as,[c("div",ns,[c("div",hs,[s.gameState!==2?(d(),g("span",ks,"等待开始")):s.isAiComputing?(d(),g("span",ls," 电脑正在思考中... ")):(d(),g("span",ps," 轮到 您 走了 "))]),c("div",ts,[c("div",es,[(d(!0),g(o,null,D(s.RC-1,p=>(d(),g("div",Es,[(d(!0),g(o,null,D(s.RC-1,y=>(d(),g("div",rs))),256))]))),256))]),c("div",ds,[(d(!0),g(o,null,D(s.chessState.state,(p,y)=>(d(),g("div",gs,[(d(!0),g(o,null,D(p,(t,r)=>(d(),g("div",{class:q(["grid flex-horiz flex-center-all",[s.lastState.state[y][r]!==t?"active":"",t===s.EMPTY?"cursor-p":""]]),onClick:F=>s.onClickChess(y,r)},[t!==s.EMPTY?(d(),g("div",{key:0,class:q(["chess bg-text",[t===s.B?"bg-black":"bg-white"]])},null,2)):_("",!0)],10,ys))),256))]))),256))]),S(l,{status:s.gameState,onOnClickStart:s.onClickRestart},{default:w(()=>[c("div",Fs,[s.gameState===3?(d(),g("span",cs,"你赢了")):s.gameState===4?(d(),g("span",Cs,"你输了")):s.gameState===5?(d(),g("span",bs,"棋逢对手")):_("",!0)])]),_:1},8,["status","onOnClickStart"])])])])}const As=N(V,[["render",us],["__scopeId","data-v-7a6da86c"]]),Bs=R("",4),os=R("",5),_s=JSON.parse('{"title":"AI 五子棋","description":"","frontmatter":{},"headers":[],"relativePath":"games/five-chess.md","filePath":"games/five-chess.md"}'),Ds={name:"games/five-chess.md"},xs=Object.assign(Ds,{setup(s){return(k,a)=>{const i=x("ClientOnly");return d(),g("div",null,[Bs,S(i,null,{default:w(()=>[S(As)]),_:1}),os])}}});export{_s as __pageData,xs as default};
