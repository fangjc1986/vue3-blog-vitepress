var u=Object.defineProperty;var m=(s,n,a)=>n in s?u(s,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[n]=a;var r=(s,n,a)=>(m(s,typeof n!="symbol"?n+"":n,a),a);import{_ as y}from"./chunks/lodash.008bc52d.js";import{_ as d,o as p,c as o,a as F,b as h,F as D,h as C,s as f,d as g,e as A}from"./app.1c3b36fa.js";class _{constructor(n,a){r(this,"row",0);r(this,"column",0);r(this,"type",0);this.row=n,this.column=a}}const i=[[-1,0,1,0],[0,1,0,-1]],E={name:"SnakeGame",data(){return{area:[20,40],grids:[],snakeLength:3,snake:[],nowDir:1,runTmo:null,status:0}},mounted(){this.init(),window.addEventListener("keydown",this.keyDownEvent)},beforeDestroy(){window.removeEventListener("keydown",this.keyDownEvent)},methods:{restart(){clearTimeout(this.runTmo),this.init(),this.status=1,this.runTmo=setTimeout(this.snakeRun.bind(this),500)},init(){for(let s=0;s<this.area[0];s++){this.grids[s]=[];for(let n=0;n<this.area[1];n++)this.grids[s][n]=new _(s,n)}this.snake=this.grids[0].slice(0,3).reverse().map(s=>(s.type=2,s)),this.addFood(),this.$forceUpdate()},snakeRun(){const s=this.snake[0],n=(s.row+i[0][this.nowDir]+this.area[0])%this.area[0],a=(s.column+i[1][this.nowDir]+this.area[1])%this.area[1];if(n>=this.area[0]||n<0||a>=this.area[1]||a<0)return this.gameOver();const l=this.grids[n][a];if([0,1].includes(l.type)||!this.snake.slice(1).includes(l)){this.snake.unshift(l);const e=l.type===1;[0,2].includes(l.type)&&(this.snake.pop().type=0),l.type=2,e&&this.addFood()}else return this.gameOver();this.$forceUpdate(),this.runTmo=setTimeout(this.snakeRun.bind(this),500*.9**(this.snake.length/3))},addFood(){const s=y.difference(y.flatten(this.grids),this.snake),n=s[Math.floor(s.length*Math.random())];n.type=1},keyDownEvent(s){if(!this.status||s.keyCode>40||s.keyCode<37)return;s.preventDefault();const n=(s.keyCode-34)%4;(n+2)%4!==this.nowDir&&(this.nowDir=n,clearTimeout(this.runTmo),this.snakeRun())},gameOver(){this.status=0,clearTimeout(this.runTmo)},gridStyle(s){return{"background-color":this.snake[0]===s?"blue":["#f2f2f2","#ff00ff","#000"][s.type]}}}},k={class:""},v={class:"flex-horiz"},w={class:"pa-xs pos-r",style:{border:"1px solid #eeeeee"}},q={key:0,class:"pos-a",style:{top:"100px",left:"0",right:"0"}},x={class:"flex-horiz rows",style:{}};function T(s,n,a,l,e,t){return p(),o("div",k,[F("div",v,[F("div",w,[e.status?h("",!0):(p(),o("div",q,[F("div",{class:"pa-sm restart-button",onClick:n[0]||(n[0]=(...c)=>t.restart&&t.restart(...c))}," \u70B9\u51FB\u91CD\u65B0\u5F00\u59CB ")])),(p(!0),o(D,null,C(e.grids,c=>(p(),o("div",x,[(p(!0),o(D,null,C(c,b=>(p(),o("div",{class:"grid",style:f(t.gridStyle(b))},null,4))),256))]))),256))])])])}const B=d(E,[["render",T],["__scopeId","data-v-86c6aade"]]),S=A("",4),G=A("",4),N=JSON.parse('{"title":"\u8D2A\u5403\u86C7","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"\u73A9\u6CD5","slug":"\u73A9\u6CD5","link":"#\u73A9\u6CD5","children":[]},{"level":2,"title":"\u7B97\u6CD5","slug":"\u7B97\u6CD5","link":"#\u7B97\u6CD5","children":[]},{"level":2,"title":"\u6E90\u7801","slug":"\u6E90\u7801","link":"#\u6E90\u7801","children":[]}],"relativePath":"games/snake.md"}'),R={name:"games/snake.md"},$=Object.assign(R,{setup(s){return(n,a)=>(p(),o("div",null,[S,g(B),G]))}});export{N as __pageData,$ as default};
