var m=Object.defineProperty;var B=(s,n,a)=>n in s?m(s,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[n]=a;var t=(s,n,a)=>(B(s,typeof n!="symbol"?n+"":n,a),a);import{_ as y}from"./chunks/lodash.4dce4bbd.js";import{_ as h,o as p,c as o,k as E,e as D,F as i,D as F,N as g,C as f,H as u,w as A,Q as b}from"./chunks/framework.c98d58aa.js";import"./chunks/commonjsHelpers.de833af9.js";class q{constructor(n,a){t(this,"row",0);t(this,"column",0);t(this,"type",0);this.row=n,this.column=a}}const C=[[-1,0,1,0],[0,1,0,-1]],k={name:"SnakeGame",data(){return{area:[20,40],grids:[],snakeLength:3,snake:[],nowDir:1,runTmo:null,status:0}},mounted(){this.init(),window.addEventListener("keydown",this.keyDownEvent)},beforeDestroy(){window.removeEventListener("keydown",this.keyDownEvent)},methods:{restart(){clearTimeout(this.runTmo),this.init(),this.status=1,this.runTmo=setTimeout(this.snakeRun.bind(this),500)},init(){for(let s=0;s<this.area[0];s++){this.grids[s]=[];for(let n=0;n<this.area[1];n++)this.grids[s][n]=new q(s,n)}this.snake=this.grids[0].slice(0,3).reverse().map(s=>(s.type=2,s)),this.addFood(),this.$forceUpdate()},snakeRun(){const s=this.snake[0],n=(s.row+C[0][this.nowDir]+this.area[0])%this.area[0],a=(s.column+C[1][this.nowDir]+this.area[1])%this.area[1];if(n>=this.area[0]||n<0||a>=this.area[1]||a<0)return this.gameOver();const l=this.grids[n][a];if([0,1].includes(l.type)||!this.snake.slice(1).includes(l)){this.snake.unshift(l);const e=l.type===1;[0,2].includes(l.type)&&(this.snake.pop().type=0),l.type=2,e&&this.addFood()}else return this.gameOver();this.$forceUpdate(),this.runTmo=setTimeout(this.snakeRun.bind(this),500*.9**(this.snake.length/3))},addFood(){const s=y.difference(y.flatten(this.grids),this.snake),n=s[Math.floor(s.length*Math.random())];n.type=1},keyDownEvent(s){if(!this.status||s.keyCode>40||s.keyCode<37)return;s.preventDefault();const n=(s.keyCode-34)%4;(n+2)%4!==this.nowDir&&(this.nowDir=n,clearTimeout(this.runTmo),this.snakeRun())},gameOver(){this.status=0,clearTimeout(this.runTmo)},gridStyle(s){return{"background-color":this.snake[0]===s?"blue":["#f2f2f2","#ff00ff","#000"][s.type]}}}},v={class:""},w={class:"flex-horiz"},_={class:"pa-xs pos-r",style:{border:"1px solid #eeeeee"}},x={key:0,class:"pos-a",style:{top:"100px",left:"0",right:"0"}},T={class:"flex-horiz rows",style:{}};function G(s,n,a,l,e,r){return p(),o("div",v,[E("div",w,[E("div",_,[e.status?D("",!0):(p(),o("div",x,[E("div",{class:"pa-sm restart-button",onClick:n[0]||(n[0]=(...c)=>r.restart&&r.restart(...c))}," 点击重新开始 ")])),(p(!0),o(i,null,F(e.grids,c=>(p(),o("div",T,[(p(!0),o(i,null,F(c,d=>(p(),o("div",{class:"grid",style:g(r.gridStyle(d))},null,4))),256))]))),256))])])])}const S=h(k,[["render",G],["__scopeId","data-v-86c6aade"]]),R=b("",4),O=b("",4),z=JSON.parse('{"title":"贪吃蛇","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/snake.md","filePath":"games/snake.md"}'),L={name:"games/snake.md"},M=Object.assign(L,{setup(s){return(n,a)=>{const l=f("ClientOnly");return p(),o("div",null,[R,u(l,null,{default:A(()=>[u(S)]),_:1}),O])}}});export{z as __pageData,M as default};
