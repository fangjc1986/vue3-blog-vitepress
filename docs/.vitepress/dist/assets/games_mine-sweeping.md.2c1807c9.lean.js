import{a as K}from"./chunks/array.util.aa365c9a.js";import{d as W,h as f,x as X,_ as ss,C as q,o as e,c as b,k as E,b as h,w as o,a as i,H as c,e as z,t as O,F as U,D as G,n as ns,Z as M,a2 as P,a3 as H,N as as,Q as j}from"./chunks/framework.aa4ce59a.js";import"./chunks/number.util.14bcf861.js";class ls{constructor(l,D,C=0){this.number=0,this.isBoom=!1,this.status=0,this.row=0,this.col=0,this.focusRound=!1,this.row=l,this.col=D,this.number=0}}const ps=["#0000FF","#008000","#FF0000","#000080","#800000","#008080","#000000","#808080"],Y=[[0,1],[0,-1],[1,0],[-1,0],[-1,-1],[-1,1],[1,1],[1,-1]],os=W({name:"mine-sweeping",components:{},props:{},setup:function(n){const l=[!1,!1,!1],D=[0,0,0],C=f(0),w=f(0),x=[{label:"简单",value:1,row:9,col:9,boom:10},{label:"正常",value:2,row:16,col:16,boom:40},{label:"困难",value:3,row:16,col:30,boom:99},{label:"自定义",value:4,row:20,col:20,boom:50}],v=f(2),m=f(x.find(s=>s.value===v.value)),F=f(1);X(v,s=>{B(!1),m.value=x.find(a=>a.value===s)});const g=()=>{const{row:s,col:a,boom:p}=m.value,r=Array(s).fill("").map((d,A)=>Array(a).fill("").map((I,k)=>new ls(A,k)));return K(Array(s*a).fill("").map((d,A)=>[Math.floor(A/a),A%a]),p).forEach(([d,A])=>r[d][A].isBoom=!0),r},u=f(g()),_=async()=>{F.value=2,C.value=0,w.value=0,u.value=g(),u.value.forEach(s=>s.forEach(a=>{a.isBoom||t(a,p=>a.number+=p.isBoom?1:0)}))},t=(s,a)=>{const{row:p,col:r}=s;for(let d=0;d<Y.length;d++){const[A,I]=Y[d],k=p+A,$=r+I;y(k,$)&&a&&a(u.value[k][$])}},y=(s,a)=>{const{row:p,col:r}=m.value;return s>=0&&s<p&&a>=0&&a<r},B=(s=void 0)=>{if(u.value.forEach(a=>a.forEach(p=>p.status=p.status||1)),s===void 0)return F.value=3;F.value=4,s&&(s.status=3)},T=s=>{const a=new Set;for(const p of s)if(p.status===0){if(p.status=1,C.value++,p.isBoom)return B(p);if(C.value+m.value.boom===m.value.row*m.value.col)return B();p.number>0||t(p,r=>{r.status===0&&(a.has(r)||a.add(r))})}setTimeout(T.bind(this,a),20)},J=s=>{T([s]),V()},Q=s=>{s.status===0?(s.status=2,w.value++):s.status===2&&(s.status=0,w.value--)},Z=s=>{if(s.status!==1&&s.number===0)return;let a=0,p=[];t(s,r=>{a+=r.status===2?1:0,r.status===0&&p.push(r)}),a===s.number&&T(p)},L=s=>{t(s,a=>{a.focusRound=l[0]&&l[2]})};let R,S=0;const N=f("0.000".padStart(8,"0")),V=()=>{if(clearTimeout(R),F.value!==2){S=0;return}S===0&&(S=new Date().getTime());const s=(new Date().getTime()-S)/1e3;N.value=s.toFixed(3).padStart(8,"0"),R=setTimeout(V,1)};return{map:u,NumberColors:ps,gameState:F,levels:x,nowLevelValue:v,nowLevel:m,openCount:C,flagCount:w,timeDisplay:N,restart:_,gameOver:B,onMouseUp:(s,a)=>{if(F.value===2&&(l[s.button]=!1,L(a),D[s.button]=new Date().getTime(),!(l[0]||l[2]))){if(Math.abs(D[0]-D[2])<100)return Z(a);if(s.button===0)return J(a);if(s.button===2)return Q(a)}},onMouseDown:(s,a)=>{F.value===2&&(l[s.button]=!0,L(a))},gridClass:s=>[s.status===3?"game-over":"",s.focusRound&&s.status===0?"focus":"",s.status===1?"active":""]}}});const es={class:"mine-sweeping vue-component-container flex-column flex-center-all"},ts={class:"mb-md flex-column flex-center-all"},rs={class:"flex-horiz"},cs={class:"ml-xs"},Es={key:0,class:"flex-horiz mt-sm"},ys={class:"ml-xs"},is={class:"ml-xs"},Fs={class:"ml-xs"},us={key:0,class:"flex-horiz flex-center-all mb-xs"},bs={class:""},ms={class:"ml-xs"},Cs={class:"ml-xs"},gs={class:"ml-xs"},Bs={class:"flex-horiz"},As=["onMousedown","onMouseup"],Ds={class:""},ds={key:0,class:"iconfont icon-bug-fill"},fs={key:2,class:"iconfont icon-checkbox-blank-line color-border-light"},qs={class:"iconfont icon-flag--fill",style:{color:"#960000"}};function vs(n,l,D,C,w,x){const v=q("a-button"),m=q("a-select"),F=q("a-input-number"),g=q("a-input-group"),u=q("a-tag"),_=q("a-input");return e(),b("div",es,[E("div",ts,[E("div",rs,[n.gameState!==2?(e(),h(v,{key:0,type:"primary",onClick:n.restart},{default:o(()=>[i("开始游戏")]),_:1},8,["onClick"])):(e(),h(v,{key:1,type:"error",onClick:l[0]||(l[0]=t=>n.gameOver(!1))},{default:o(()=>[i("停止游戏")]),_:1})),E("div",cs,[c(m,{style:{width:"100px"},options:n.levels,modelValue:n.nowLevelValue,"onUpdate:modelValue":l[1]||(l[1]=t=>n.nowLevelValue=t),disabled:n.gameState===2},null,8,["options","modelValue","disabled"])])]),n.nowLevelValue===4?(e(),b("div",Es,[E("div",ys,[c(g,null,{default:o(()=>[c(F,{style:{width:"100px"},modelValue:n.nowLevel.row,"onUpdate:modelValue":l[2]||(l[2]=t=>n.nowLevel.row=t),disabled:n.gameState===2},{prefix:o(()=>[i(" 行 ")]),_:1},8,["modelValue","disabled"])]),_:1})]),E("div",is,[c(g,null,{default:o(()=>[c(F,{style:{width:"100px"},modelValue:n.nowLevel.col,"onUpdate:modelValue":l[3]||(l[3]=t=>n.nowLevel.col=t),disabled:n.gameState===2},{prefix:o(()=>[i(" 列 ")]),_:1},8,["modelValue","disabled"])]),_:1})]),E("div",Fs,[c(g,null,{default:o(()=>[c(F,{style:{width:"100px"},modelValue:n.nowLevel.boom,"onUpdate:modelValue":l[4]||(l[4]=t=>n.nowLevel.boom=t),disabled:n.gameState===2},{prefix:o(()=>[i(" 雷 ")]),_:1},8,["modelValue","disabled"])]),_:1})])])):z("",!0)]),n.gameState!==1?(e(),b("div",us,[E("div",bs,[n.gameState===1?(e(),h(u,{key:0},{default:o(()=>[i("未开始")]),_:1})):n.gameState===2?(e(),h(u,{key:1,type:"info"},{default:o(()=>[i("游戏中")]),_:1})):n.gameState===3?(e(),h(u,{key:2,type:"success"},{default:o(()=>[i("胜利！")]),_:1})):(e(),h(u,{key:3,type:"error"},{default:o(()=>[i("失败！")]),_:1}))]),E("div",ms,[c(g,null,{default:o(()=>[c(_,{style:{width:"100px"},readonly:!0,"model-value":`${n.flagCount} / ${n.nowLevel.boom}`},{prefix:o(()=>[i("雷")]),_:1},8,["model-value"])]),_:1})]),E("div",Cs,[c(g,null,{default:o(()=>[c(_,{style:{width:"100px"},readonly:!0,"model-value":`${n.openCount} / ${n.nowLevel.row*n.nowLevel.col}`},{prefix:o(()=>[i("扫")]),_:1},8,["model-value"])]),_:1})]),E("div",gs,[c(u,{type:"info",style:{width:"80px","text-align":"center"}},{default:o(()=>[i(O(n.timeDisplay),1)]),_:1})])])):z("",!0),E("div",{class:"grid-container flex-column",onselectstart:"return false",onContextmenu:l[6]||(l[6]=M(()=>{},["prevent"]))},[(e(!0),b(U,null,G(n.map,t=>(e(),b("div",Bs,[(e(!0),b(U,null,G(t,y=>(e(),b("div",{class:ns(["grid flex-horiz flex-center-all",n.gridClass(y)]),onContextmenu:l[5]||(l[5]=M(()=>{},["prevent"])),onMousedown:M(B=>n.onMouseDown(B,y),["prevent","stop"]),onMouseup:M(B=>n.onMouseUp(B,y),["prevent","stop"])},[P(E("div",Ds,[y.isBoom?(e(),b("i",ds)):y.number>0?(e(),b("span",{key:1,class:"grid-number",style:as({color:n.NumberColors[y.number-1]})},O(y.number),5)):(e(),b("i",fs))],512),[[H,y.status===1||y.status===3]]),P(E("i",qs,null,512),[[H,y.status===2]])],42,As))),256))]))),256))],32)])}const hs=ss(os,[["render",vs],["__scopeId","data-v-6ef8902c"]]),ws=j("",4),xs=j("",13),Ts=JSON.parse('{"title":"经典连连看","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/mine-sweeping.md","filePath":"games/mine-sweeping.md"}'),_s={name:"games/mine-sweeping.md"},Ls=Object.assign(_s,{setup(n){return(l,D)=>{const C=q("ClientOnly");return e(),b("div",null,[ws,c(C,null,{default:o(()=>[c(hs)]),_:1}),xs])}}});export{Ts as __pageData,Ls as default};
