import{S as ls}from"./chunks/start-over-mask.13ccb049.js";import{g as m}from"./chunks/number.util.14bcf861.js";import{d as ps,h as X,j as os,a1 as es,_ as cs,C as R,o as _,c as z,k as S,H as d,N as rs,w as ts,Q as P}from"./chunks/framework.aa4ce59a.js";class B{constructor(y,p){this.width=y,this.height=p,this.h=0,this.posX=0,this.createTime=new Date().getTime()}}const Es=ps({name:"parkour",components:{StartOverMask:ls},props:{},setup(e){const y=X(""),p=800,c=400;os(()=>{window.addEventListener("keydown",v),window.addEventListener("keyup",q),o=y.value.getContext("2d"),o.fillStyle="black",o.fillRect(0,c-b,p,b)}),es(()=>{window.removeEventListener("keydown",v),window.removeEventListener("keyup",q)});let h=null,E=X(1),o=null,i=0,M=-.005,I=.7,D=0,A=0,g=0,L=100,b=10,r=30,t=[],H=.2,f=.1,x=.5,F=0,u=0,a=new B(r,r);const w=()=>{clearTimeout(h),E.value===2&&(u=new Date().getTime(),O(),J(),k(),N(),$(),h=setTimeout(w,1))},O=()=>{o.clearRect(0,0,p,c-b)},J=()=>{const s=u-D,n=u-a.createTime;a.posX+=F*n,a.posX=Math.max(0,a.posX),a.posX=Math.min(p-r,a.posX),a.createTime=u,a.h=M*s*s/2+A*s+g,a.h=Math.max(0,a.h),o.fillStyle="#1ebabe",o.fillRect(a.posX,c-a.h-r-b,r,r)},V=s=>c-s.h-s.height-b,N=()=>{const s=t.length?t[t.length-1]:null;if(s==null){const n=new B(m(20,50),m(20,200));n.posX=p,n.h=0,t.push(n)}else if(s.posX<p+100){const n=new B(m(20,50),m(20,200));n.posX=s.posX+s.width+m(0,300),n.h=0,t.push(n)}},$=()=>{const s=[];let n=!1;for(const l of t){if(l.posX<-500)continue;o.fillStyle="black";const C=u-l.createTime;l.posX=l.posX-f*C,l.createTime=u,o.fillRect(l.posX,V(l),l.width,l.height),s.push(l),n||(n=j(a,l))}if(n)return U();t=s},U=()=>{E.value=3},j=(s,n)=>{const l=[s.posX,s.h+s.height];s.posX+s.width,s.h+s.height;const C=[s.posX,s.h],ss=[s.posX+s.width,s.h],ns=[n.posX,n.h+n.height];n.posX+n.width,n.h+n.height;const as=[n.posX,n.h],T=[n.posX+n.width,n.h];return!(C[1]>=ns[1]||C[0]>=T[0]||l[1]<=T[1]||ss[0]<=as[0])},k=()=>{i<=0||new Date().getTime()-i>400||(A=I,D=new Date().getTime(),g=a.h)},v=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Y();if([39,68].includes(s.keyCode))return G();if([65,37].includes(s.keyCode))return K()},q=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Z();if([39,68].includes(s.keyCode))return Q();if([65,37].includes(s.keyCode))return W()},G=()=>{F=Math.abs(x)},Q=()=>{F=0},K=()=>{F=-Math.abs(x)},W=()=>{F=0},Y=()=>{a.h===0&&(i=-1),!(a.h!==0||i>0)&&(i=new Date().getTime(),k())},Z=()=>{i=-1};return{canvasRef:y,width:p,height:c,status:E,clickStart:()=>{E.value=[0,2,3,2][E.value],E.value===2&&(a=new B(r,r),a.posX=L,a.h=0,F=0,f=H,t=[],w())}}}});const ys={class:"parkour flex-column flex-center-all"},is=["width","height"];function Fs(e,y,p,c,h,E){const o=R("start-over-mask");return _(),z("div",ys,[S("div",{class:"pos-r",style:rs({width:e.width+"px",height:e.height+"px"})},[S("canvas",{ref:"canvasRef",width:e.width,height:e.height,style:{"background-color":"#f5f5f5"}},null,8,is),d(o,{status:e.status,onOnClickStart:e.clickStart},null,8,["status","onOnClickStart"])],4)])}const us=cs(Es,[["render",Fs],["__scopeId","data-v-d1f94fc9"]]),bs=P("",5),ms=P("",12),Ds=JSON.parse('{"title":"砖块跑酷","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/parkour.md","filePath":"games/parkour.md"}'),Cs={name:"games/parkour.md"},As=Object.assign(Cs,{setup(e){return(y,p)=>{const c=R("ClientOnly");return _(),z("div",null,[bs,d(c,null,{default:ts(()=>[d(us)]),_:1}),ms])}}});export{Ds as __pageData,As as default};
