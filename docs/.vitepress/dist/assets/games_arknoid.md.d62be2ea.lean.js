var f=Object.defineProperty;var g=(n,s,a)=>s in n?f(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a;var t=(n,s,a)=>(g(n,typeof s!="symbol"?s+"":s,a),a);import"./chunks/lodash.008bc52d.js";import{_ as E,o as i,c as b,a as A,b as v,d as W,e as h}from"./app.1c3b36fa.js";const l=Math,y=Math.PI,D=class{constructor(s,a){t(this,"x1",0);t(this,"y1",0);t(this,"x2",0);t(this,"y2",0);t(this,"show",!0);this.x1=s,this.y1=a,this.x2=s+D.w,this.y2=a+D.h}};let p=D;t(p,"w",50),t(p,"h",20),t(p,"row",7),t(p,"column",6);const w={name:"ArknoidGame",data(){return{step:2,gameTime:0,remainTile:0,runTmo:null,ctx:null,lineWall:{w:100,h:10,x:0,y:450,last:[]},canvas:{w:800,h:480},ball:{r:3,x:100,y:100,dir:[l.cos(y/4),-l.sin(y/4)]},tiles:[],status:0}},mounted(){this.ctx=this.$refs.canvas.getContext("2d"),this.resetStatus()},beforeDestroy(){clearTimeout(this.runTmo)},methods:{restart(){this.status=1,this.resetStatus(),this.runtime()},resetStatus(){this.lineWall.x=(this.canvas.w-this.lineWall.w)/2,this.ball.x=this.lineWall.x+this.lineWall.w/2,this.ball.y=this.canvas.h-40,this.ball.dir=[l.cos(y/4)*this.step,-l.sin(y/4)*this.step],this.remainTile=p.row*p.column*2,this.resetTiles(),this.renderTiles(),this.renderLineWall(),this.renderBall()},gameOver(){this.status=0,clearTimeout(this.runTmo)},runtime(){this.ctx.clearRect(0,0,this.$refs.canvas.offsetWidth,this.$refs.canvas.offsetHeight),this.computeCrashWall()||this.computeCrashLineWall()||this.computeCrashTiles(),this.renderLineWall(),this.renderTiles(),this.renderBall(),this.status&&(this.runTmo=setTimeout(this.runtime.bind(this),1))},computeCrashWall(){return this.ball.x+this.ball.r>=this.canvas.w?(this.ball.dir[0]=-l.abs(this.ball.dir[0]),!1):this.ball.x<=0?(this.ball.dir[0]=l.abs(this.ball.dir[0]),!1):this.ball.y<=0?(this.ball.dir[1]=l.abs(this.ball.dir[1]),!1):(this.ball.y>this.canvas.h&&this.gameOver(),!1)},computeCrashTiles(){const n=this.ball.x-this.ball.r,s=this.ball.x+this.ball.r,a=this.ball.y-this.ball.r,o=this.ball.y+this.ball.r,r=[this.ball.dir[0]>=0?1:0,this.ball.dir[1]>=0?1:0],e=[r[0]?s:n,r[1]?o:a],c=p.column*(p.w+1),m=p.row*(p.h+1);if(e[1]<50||e[1]>50+m||e[0]<50||e[0]>450+c||e[0]<450&&e[0]>50+c)return!1;const d=l.floor((e[1]-50)/(p.h+1)),u=e[0]>400?1:0,x=l.floor((e[0]-(u?400:0)-50)/(p.w+1)),F=this.tiles[u][d][x];if(!F.show)return!1;const C=[r[0]?e[0]-F.x1:F.x2-e[0],r[1]?e[1]-F.y1:F.y2-e[1]];C[0]<0||C[1]<C[0]?this.ball.dir[1]=-this.ball.dir[1]:this.ball.dir[0]=-this.ball.dir[0],F.show=!1,--this.remainTile<=0&&this.gameOver()},computeCrashLineWall(){if(this.ball.dir[1]>=0&&this.ball.y+this.ball.r>=this.lineWall.y&&this.ball.x+this.ball.r>this.lineWall.x&&this.ball.x-this.ball.r<this.lineWall.x+this.lineWall.w){const n=(this.ball.x-this.lineWall.x-this.lineWall.w/2)/100,s=l.abs(l.max(l.min(n,.5),-.5)),a=l.abs(l.atan(this.ball.dir[1]/this.ball.dir[0]));if(this.ball.dir[0]>=0){const o=n>0?a-a*s:a+(y-a)*s;this.ball.dir[0]=l.cos(o)*this.step,this.ball.dir[1]=-l.abs(l.sin(o))*this.step}else{const o=n>0?a+(y-a)*s:a-a*s;this.ball.dir[0]=-l.cos(o)*this.step,this.ball.dir[1]=-l.abs(l.sin(o))*this.step}return!0}return!1},onMouseMove(n){this.lineWall.x=n.offsetX-this.lineWall.w/2},resetTiles(){for(let n=0;n<2;n++){const s=n*400+50,a=50;this.tiles[n]=[];for(let o=0;o<p.row;o++){this.tiles[n][o]=[];for(let r=0;r<6;r++)this.tiles[n][o][r]=new p(r*(p.w+1)+s,o*(p.h+1)+a)}}},renderTiles(){this.ctx.fillStyle="#001f3f";for(let n=0;n<this.tiles.length;n++)for(let s=0;s<this.tiles[n].length;s++)for(let a=0;a<this.tiles[n][s].length;a++){const o=this.tiles[n][s][a];!o.show||this.ctx.fillRect(o.x1,o.y1,p.w,p.h)}},renderBall(){this.ctx.fillStyle="#FF851B ",this.ctx.beginPath(),this.ball.x+=this.ball.dir[0],this.ball.y+=this.ball.dir[1],this.ctx.arc(this.ball.x,this.ball.y,this.ball.r,0,2*Math.PI),this.ctx.fill()},renderLineWall(){const n=this.canvas.w-this.lineWall.w;let s=this.lineWall.x;s>n&&(s=n),s<0&&(s=0),this.lineWall.last.push(this.lineWall.x),this.lineWall.last.length>10&&this.lineWall.last.shift(),this.ctx.fillStyle="#0a0a76",this.ctx.fillRect(s,this.lineWall.y,this.lineWall.w,this.lineWall.h)}}},T={class:"ArknoidGame flex-column flex-center-all"},_={class:"pos-r",style:{height:"480px",width:"800px"}},M={key:0,class:"pos-a",style:{top:"150px","z-index":"2",left:"0",right:"0"}};function q(n,s,a,o,r,e){return i(),b("div",T,[A("div",_,[A("canvas",{class:"canvas",width:"800",height:"480",ref:"canvas",onMousemove:s[0]||(s[0]=(...c)=>e.onMouseMove&&e.onMouseMove(...c))},null,544),r.status?v("",!0):(i(),b("div",M,[A("div",{class:"color-text fz-lg cursor-p ptb-sm font-bold bg-white text-center",style:{width:"130px",margin:"auto",border:"5px solid #cccccc"},onClick:s[1]||(s[1]=(...c)=>e.restart&&e.restart(...c))}," \u70B9\u51FB\u5F00\u59CB ")]))])])}const k=E(w,[["render",q],["__scopeId","data-v-aed34944"]]),P=h("",4),S=h("",9),O=JSON.parse('{"title":"\u6253\u7816\u5757","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"\u73A9\u6CD5","slug":"\u73A9\u6CD5","link":"#\u73A9\u6CD5","children":[]},{"level":2,"title":"\u7B97\u6CD5","slug":"\u7B97\u6CD5","link":"#\u7B97\u6CD5","children":[{"level":3,"title":"\u53CD\u5F39","slug":"\u53CD\u5F39","link":"#\u53CD\u5F39","children":[]},{"level":3,"title":"\u7816\u5757\u78B0\u649E\u8BA1\u7B97","slug":"\u7816\u5757\u78B0\u649E\u8BA1\u7B97","link":"#\u7816\u5757\u78B0\u649E\u8BA1\u7B97","children":[]}]},{"level":2,"title":"\u6E90\u7801","slug":"\u6E90\u7801","link":"#\u6E90\u7801","children":[]}],"relativePath":"games/arknoid.md"}'),I={name:"games/arknoid.md"},R=Object.assign(I,{setup(n){return(s,a)=>(i(),b("div",null,[P,W(k),S]))}});export{O as __pageData,R as default};
