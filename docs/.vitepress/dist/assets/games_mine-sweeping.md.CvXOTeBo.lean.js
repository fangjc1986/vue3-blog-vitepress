import{a as W}from"./chunks/array.util.DVdZD237.js";import{e as X,r as A,w as Z,a0 as ss,j as D,k,p as F,n as E,l as v,m as h,y as d,v as e,s as I,z as O,F as P,P as U,u as is,H as T,M as G,N as H,q as as,Q as J}from"./chunks/framework.DXL0bVlL.js";import"./chunks/number.util.Cpjkx7EM.js";class ns{constructor(n,m,u=0){this.number=0,this.isBoom=!1,this.status=0,this.row=0,this.col=0,this.focusRound=!1,this.row=n,this.col=m,this.number=0}}const ls=["#0000FF","#008000","#FF0000","#000080","#800000","#008080","#000000","#808080"],j=[[0,1],[0,-1],[1,0],[-1,0],[-1,-1],[-1,1],[1,1],[1,-1]],hs=X({name:"mine-sweeping",components:{},props:{},setup:function(i){const n=[!1,!1,!1],m=[0,0,0],u=A(0),q=A(0),w=[{label:"简单",value:1,row:9,col:9,boom:10},{label:"正常",value:2,row:16,col:16,boom:40},{label:"困难",value:3,row:16,col:30,boom:99},{label:"自定义",value:4,row:20,col:20,boom:50}],f=A(2),c=A(w.find(s=>s.value===f.value)),g=A(1);Z(f,s=>{o(!1),c.value=w.find(a=>a.value===s)});const b=()=>{const{row:s,col:a,boom:l}=c.value,t=Array(s).fill("").map((B,C)=>Array(a).fill("").map(($,S)=>new ns(C,S)));return W(Array(s*a).fill("").map((B,C)=>[Math.floor(C/a),C%a]),l).forEach(([B,C])=>t[B][C].isBoom=!0),t},y=A(b()),_=async()=>{g.value=2,u.value=0,q.value=0,y.value=b(),y.value.forEach(s=>s.forEach(a=>{a.isBoom||p(a,l=>a.number+=l.isBoom?1:0)}))},p=(s,a)=>{const{row:l,col:t}=s;for(let B=0;B<j.length;B++){const[C,$]=j[B],S=l+C,z=t+$;r(S,z)&&a&&a(y.value[S][z])}},r=(s,a)=>{const{row:l,col:t}=c.value;return s>=0&&s<l&&a>=0&&a<t},o=(s=void 0)=>{if(y.value.forEach(a=>a.forEach(l=>l.status=l.status||1)),s===void 0)return g.value=3;g.value=4,s&&(s.status=3)},M=s=>{const a=new Set;for(const l of s)if(l.status===0){if(l.status=1,u.value++,l.isBoom)return o(l);if(u.value+c.value.boom===c.value.row*c.value.col)return o();l.number>0||p(l,t=>{t.status===0&&(a.has(t)||a.add(t))})}setTimeout(M.bind(this,a),20)},Q=s=>{M([s]),N()},Y=s=>{s.status===0?(s.status=2,q.value++):s.status===2&&(s.status=0,q.value--)},K=s=>{if(s.status!==1&&s.number===0)return;let a=0,l=[];p(s,t=>{a+=t.status===2?1:0,t.status===0&&l.push(t)}),a===s.number&&M(l)},L=s=>{p(s,a=>{a.focusRound=n[0]&&n[2]})};let V,x=0;const R=A("0.000".padStart(8,"0")),N=()=>{if(clearTimeout(V),g.value!==2){x=0;return}x===0&&(x=new Date().getTime());const s=(new Date().getTime()-x)/1e3;R.value=s.toFixed(3).padStart(8,"0"),V=setTimeout(N,1)};return{map:y,NumberColors:ls,gameState:g,levels:w,nowLevelValue:f,nowLevel:c,openCount:u,flagCount:q,timeDisplay:R,restart:_,gameOver:o,onMouseUp:(s,a)=>{if(g.value===2&&(n[s.button]=!1,L(a),m[s.button]=new Date().getTime(),!(n[0]||n[2]))){if(Math.abs(m[0]-m[2])<100)return K(a);if(s.button===0)return Q(a);if(s.button===2)return Y(a)}},onMouseDown:(s,a)=>{g.value===2&&(n[s.button]=!0,L(a))},gridClass:s=>[s.status===3?"game-over":"",s.focusRound&&s.status===0?"focus":"",s.status===1?"active":""]}}}),ks={class:"mine-sweeping vue-component-container flex-column flex-center-all"},ps={class:"mb-md flex-column flex-center-all"},ts={class:"flex-horiz"},es={class:"ml-xs"},Es={key:0,class:"flex-horiz mt-sm"},rs={class:"ml-xs"},ds={class:"ml-xs"},gs={class:"ml-xs"},ys={key:0,class:"flex-horiz flex-center-all mb-xs"},Fs={class:""},cs={class:"ml-xs"},us={class:"ml-xs"},bs={class:"ml-xs"},os={class:"flex-horiz"},Cs=["onMousedown","onMouseup"],ms={class:""},Bs={key:0,class:"iconfont icon-bug-fill"},As={key:2,class:"iconfont icon-checkbox-blank-line color-border-light"},Ds={class:"iconfont icon-flag--fill",style:{color:"#960000"}};function fs(i,n,m,u,q,w){const f=D("a-button"),c=D("a-select"),g=D("a-input-number"),b=D("a-input-group"),y=D("a-tag"),_=D("a-input");return k(),F("div",ks,[E("div",ps,[E("div",ts,[i.gameState!==2?(k(),v(f,{key:0,type:"primary",onClick:i.restart},{default:h(()=>[d("开始游戏")]),_:1},8,["onClick"])):(k(),v(f,{key:1,type:"error",onClick:n[0]||(n[0]=p=>i.gameOver(!1))},{default:h(()=>[d("停止游戏")]),_:1})),E("div",es,[e(c,{style:{width:"100px"},options:i.levels,modelValue:i.nowLevelValue,"onUpdate:modelValue":n[1]||(n[1]=p=>i.nowLevelValue=p),disabled:i.gameState===2},null,8,["options","modelValue","disabled"])])]),i.nowLevelValue===4?(k(),F("div",Es,[E("div",rs,[e(b,null,{default:h(()=>[e(g,{style:{width:"100px"},modelValue:i.nowLevel.row,"onUpdate:modelValue":n[2]||(n[2]=p=>i.nowLevel.row=p),disabled:i.gameState===2},{prefix:h(()=>[d(" 行 ")]),_:1},8,["modelValue","disabled"])]),_:1})]),E("div",ds,[e(b,null,{default:h(()=>[e(g,{style:{width:"100px"},modelValue:i.nowLevel.col,"onUpdate:modelValue":n[3]||(n[3]=p=>i.nowLevel.col=p),disabled:i.gameState===2},{prefix:h(()=>[d(" 列 ")]),_:1},8,["modelValue","disabled"])]),_:1})]),E("div",gs,[e(b,null,{default:h(()=>[e(g,{style:{width:"100px"},modelValue:i.nowLevel.boom,"onUpdate:modelValue":n[4]||(n[4]=p=>i.nowLevel.boom=p),disabled:i.gameState===2},{prefix:h(()=>[d(" 雷 ")]),_:1},8,["modelValue","disabled"])]),_:1})])])):I("",!0)]),i.gameState!==1?(k(),F("div",ys,[E("div",Fs,[i.gameState===1?(k(),v(y,{key:0},{default:h(()=>[d("未开始")]),_:1})):i.gameState===2?(k(),v(y,{key:1,type:"info"},{default:h(()=>[d("游戏中")]),_:1})):i.gameState===3?(k(),v(y,{key:2,type:"success"},{default:h(()=>[d("胜利！")]),_:1})):(k(),v(y,{key:3,type:"error"},{default:h(()=>[d("失败！")]),_:1}))]),E("div",cs,[e(b,null,{default:h(()=>[e(_,{style:{width:"100px"},readonly:!0,"model-value":`${i.flagCount} / ${i.nowLevel.boom}`},{prefix:h(()=>[d("雷")]),_:1},8,["model-value"])]),_:1})]),E("div",us,[e(b,null,{default:h(()=>[e(_,{style:{width:"100px"},readonly:!0,"model-value":`${i.openCount} / ${i.nowLevel.row*i.nowLevel.col}`},{prefix:h(()=>[d("扫")]),_:1},8,["model-value"])]),_:1})]),E("div",bs,[e(y,{type:"info",style:{width:"80px","text-align":"center"}},{default:h(()=>[d(O(i.timeDisplay),1)]),_:1})])])):I("",!0),E("div",{class:"grid-container flex-column",onselectstart:"return false",onContextmenu:n[6]||(n[6]=T(()=>{},["prevent"]))},[(k(!0),F(P,null,U(i.map,p=>(k(),F("div",os,[(k(!0),F(P,null,U(p,r=>(k(),F("div",{class:is(["grid flex-horiz flex-center-all",i.gridClass(r)]),onContextmenu:n[5]||(n[5]=T(()=>{},["prevent"])),onMousedown:T(o=>i.onMouseDown(o,r),["prevent","stop"]),onMouseup:T(o=>i.onMouseUp(o,r),["prevent","stop"])},[G(E("div",ms,[r.isBoom?(k(),F("i",Bs)):r.number>0?(k(),F("span",{key:1,class:"grid-number",style:as({color:i.NumberColors[r.number-1]})},O(r.number),5)):(k(),F("i",As))],512),[[H,r.status===1||r.status===3]]),G(E("i",Ds,null,512),[[H,r.status===2]])],42,Cs))),256))]))),256))],32)])}const vs=ss(hs,[["render",fs],["__scopeId","data-v-6ef8902c"]]),qs=J("",4),ws=J("",13),Ms=JSON.parse('{"title":"经典连连看","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/mine-sweeping.md","filePath":"games/mine-sweeping.md"}'),_s={name:"games/mine-sweeping.md"},Ls=Object.assign(_s,{setup(i){return(n,m)=>{const u=D("ClientOnly");return k(),F("div",null,[qs,e(u,null,{default:h(()=>[e(vs)]),_:1}),ws])}}});export{Ms as __pageData,Ls as default};
