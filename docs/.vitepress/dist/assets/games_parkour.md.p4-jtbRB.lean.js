import{S as ns}from"./chunks/start-over-mask.4OJQFRBA.js";import{g as c}from"./chunks/number.util.Cpjkx7EM.js";import{e as hs,r as X,o as ls,A as ks,a0 as ps,j as _,k as R,p as P,n as S,v as C,q as ts,m as es,Q as z}from"./chunks/framework.Cg7Czl7i.js";class o{constructor(r,h){this.width=r,this.height=h,this.h=0,this.posX=0,this.createTime=new Date().getTime()}}const Es=hs({name:"parkour",components:{StartOverMask:ns},props:{},setup(k){const r=X(""),h=800,p=400;ls(()=>{window.addEventListener("keydown",v),window.addEventListener("keyup",T),l=r.value.getContext("2d"),l.fillStyle="black",l.fillRect(0,p-F,h,F)}),ks(()=>{window.removeEventListener("keydown",v),window.removeEventListener("keyup",T)});let u=null,E=X(1),l=null,d=0,M=-.005,I=.7,m=0,B=0,D=0,L=100,F=10,t=30,e=[],O=.2,A=.1,f=.5,g=0,y=0,a=new o(t,t);const x=()=>{clearTimeout(u),E.value===2&&(y=new Date().getTime(),V(),J(),w(),N(),$(),u=setTimeout(x,1))},V=()=>{l.clearRect(0,0,h,p-F)},J=()=>{const s=y-m,i=y-a.createTime;a.posX+=g*i,a.posX=Math.max(0,a.posX),a.posX=Math.min(h-t,a.posX),a.createTime=y,a.h=M*s*s/2+B*s+D,a.h=Math.max(0,a.h),l.fillStyle="#1ebabe",l.fillRect(a.posX,p-a.h-t-F,t,t)},H=s=>p-s.h-s.height-F,N=()=>{const s=e.length?e[e.length-1]:null;if(s==null){const i=new o(c(20,50),c(20,200));i.posX=h,i.h=0,e.push(i)}else if(s.posX<h+100){const i=new o(c(20,50),c(20,200));i.posX=s.posX+s.width+c(0,300),i.h=0,e.push(i)}},$=()=>{const s=[];let i=!1;for(const n of e){if(n.posX<-500)continue;l.fillStyle="black";const b=y-n.createTime;n.posX=n.posX-A*b,n.createTime=y,l.fillRect(n.posX,H(n),n.width,n.height),s.push(n),i||(i=j(a,n))}if(i)return U();e=s},U=()=>{E.value=3},j=(s,i)=>{const n=[s.posX,s.h+s.height];s.posX+s.width,s.h+s.height;const b=[s.posX,s.h],ss=[s.posX+s.width,s.h],is=[i.posX,i.h+i.height];i.posX+i.width,i.h+i.height;const as=[i.posX,i.h],q=[i.posX+i.width,i.h];return!(b[1]>=is[1]||b[0]>=q[0]||n[1]<=q[1]||ss[0]<=as[0])},w=()=>{d<=0||new Date().getTime()-d>400||(B=I,m=new Date().getTime(),D=a.h)},v=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Y();if([39,68].includes(s.keyCode))return G();if([65,37].includes(s.keyCode))return K()},T=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Z();if([39,68].includes(s.keyCode))return Q();if([65,37].includes(s.keyCode))return W()},G=()=>{g=Math.abs(f)},Q=()=>{g=0},K=()=>{g=-Math.abs(f)},W=()=>{g=0},Y=()=>{a.h===0&&(d=-1),!(a.h!==0||d>0)&&(d=new Date().getTime(),w())},Z=()=>{d=-1};return{canvasRef:r,width:h,height:p,status:E,clickStart:()=>{E.value=[0,2,3,2][E.value],E.value===2&&(a=new o(t,t),a.posX=L,a.h=0,g=0,A=O,e=[],x())}}}}),rs={class:"parkour flex-column flex-center-all"},ds=["width","height"];function gs(k,r,h,p,u,E){const l=_("start-over-mask");return R(),P("div",rs,[S("div",{class:"pos-r",style:ts({width:k.width+"px",height:k.height+"px"})},[S("canvas",{ref:"canvasRef",width:k.width,height:k.height,style:{"background-color":"#f5f5f5"}},null,8,ds),C(l,{status:k.status,onOnClickStart:k.clickStart},null,8,["status","onOnClickStart"])],4)])}const ys=ps(Es,[["render",gs],["__scopeId","data-v-d1f94fc9"]]),Fs=z("",5),cs=z("",12),ms=JSON.parse('{"title":"砖块跑酷","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"games/parkour.md","filePath":"games/parkour.md"}'),bs={name:"games/parkour.md"},Bs=Object.assign(bs,{setup(k){return(r,h)=>{const p=_("ClientOnly");return R(),P("div",null,[Fs,C(p,null,{default:es(()=>[C(ys)]),_:1}),cs])}}});export{ms as __pageData,Bs as default};
