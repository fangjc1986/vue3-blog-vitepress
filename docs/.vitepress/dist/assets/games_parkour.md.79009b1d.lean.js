var ls=Object.defineProperty;var ps=(p,o,l)=>o in p?ls(p,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):p[o]=l;var i=(p,o,l)=>(ps(p,typeof o!="symbol"?o+"":o,l),l);import{S as os}from"./chunks/start-over-mask.df5c4d55.js";import{g as u}from"./chunks/number.util.6354c1c0.js";import{g as es,r as _,m as rs,A as cs,_ as ts,o as q,c as R,a as S,d as z,s as Fs,i as ys,e as P}from"./app.1c3b36fa.js";class d{constructor(o,l){i(this,"width");i(this,"height");i(this,"createTime");i(this,"posX");i(this,"h");this.width=o,this.height=l,this.h=0,this.posX=0,this.createTime=new Date().getTime()}}const Ds=es({name:"parkour",components:{StartOverMask:os},props:{},setup(p){const o=_(""),l=800,y=400;rs(()=>{window.addEventListener("keydown",v),window.addEventListener("keyup",T),r=o.value.getContext("2d"),r.fillStyle="black",r.fillRect(0,y-b,l,b)}),cs(()=>{window.removeEventListener("keydown",v),window.removeEventListener("keyup",T)});let h=null,F=_(1),r=null,D=0,M=-.005,I=.7,g=0,f=0,x=0,L=100,b=10,c=30,t=[],O=.2,w=.1,E=.5,C=0,A=0,a=new d(c,c);const k=()=>{clearTimeout(h),F.value===2&&(A=new Date().getTime(),V(),J(),B(),N(),$(),h=setTimeout(k,1))},V=()=>{r.clearRect(0,0,l,y-b)},J=()=>{const s=A-g,n=A-a.createTime;a.posX+=C*n,a.posX=Math.max(0,a.posX),a.posX=Math.min(l-c,a.posX),a.createTime=A,a.h=M*s*s/2+f*s+x,a.h=Math.max(0,a.h),r.fillStyle="#1ebabe",r.fillRect(a.posX,y-a.h-c-b,c,c)},H=s=>y-s.h-s.height-b,N=()=>{const s=t.length?t[t.length-1]:null;if(s==null){const n=new d(u(20,50),u(20,200));n.posX=l,n.h=0,t.push(n)}else if(s.posX<l+100){const n=new d(u(20,50),u(20,200));n.posX=s.posX+s.width+u(0,300),n.h=0,t.push(n)}},$=()=>{const s=[];let n=!1;for(const e of t){if(e.posX<-500)continue;r.fillStyle="black";const m=A-e.createTime;e.posX=e.posX-w*m,e.createTime=A,r.fillRect(e.posX,H(e),e.width,e.height),s.push(e),n||(n=j(a,e))}if(n)return U();t=s},U=()=>{F.value=3},j=(s,n)=>{const e=[s.posX,s.h+s.height];s.posX+s.width,s.h+s.height;const m=[s.posX,s.h],ss=[s.posX+s.width,s.h],ns=[n.posX,n.h+n.height];n.posX+n.width,n.h+n.height;const as=[n.posX,n.h],X=[n.posX+n.width,n.h];return!(m[1]>=ns[1]||m[0]>=X[0]||e[1]<=X[1]||ss[0]<=as[0])},B=()=>{D<=0||new Date().getTime()-D>400||(f=I,g=new Date().getTime(),x=a.h)},v=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Y();if([39,68].includes(s.keyCode))return G();if([65,37].includes(s.keyCode))return Q()},T=s=>{if(s.preventDefault(),[32,38,87].includes(s.keyCode))return Z();if([39,68].includes(s.keyCode))return K();if([65,37].includes(s.keyCode))return W()},G=()=>{C=Math.abs(E)},K=()=>{C=0},Q=()=>{C=-Math.abs(E)},W=()=>{C=0},Y=()=>{a.h===0&&(D=-1),!(a.h!==0||D>0)&&(D=new Date().getTime(),B())},Z=()=>{D=-1};return{canvasRef:o,width:l,height:y,status:F,clickStart:()=>{F.value=[0,2,3,2][F.value],F.value===2&&(a=new d(c,c),a.posX=L,a.h=0,C=0,w=O,t=[],k())}}}});const Cs={class:"parkour flex-column flex-center-all"},As=["width","height"];function is(p,o,l,y,h,F){const r=ys("start-over-mask");return q(),R("div",Cs,[S("div",{class:"pos-r",style:Fs({width:p.width+"px",height:p.height+"px"})},[S("canvas",{ref:"canvasRef",width:p.width,height:p.height,style:{"background-color":"#f5f5f5"}},null,8,As),z(r,{status:p.status,onOnClickStart:p.clickStart},null,8,["status","onOnClickStart"])],4)])}const bs=ts(Ds,[["render",is],["__scopeId","data-v-d1f94fc9"]]),us=P("",5),ms=P("",12),ws=JSON.parse('{"title":"\u7816\u5757\u8DD1\u9177","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"\u73A9\u6CD5","slug":"\u73A9\u6CD5","link":"#\u73A9\u6CD5","children":[]},{"level":2,"title":"\u7B97\u6CD5","slug":"\u7B97\u6CD5","link":"#\u7B97\u6CD5","children":[{"level":3,"title":"\u969C\u788D\u7269\u751F\u4EA7","slug":"\u969C\u788D\u7269\u751F\u4EA7","link":"#\u969C\u788D\u7269\u751F\u4EA7","children":[]},{"level":3,"title":"\u65B9\u5757\u5904\u7406","slug":"\u65B9\u5757\u5904\u7406","link":"#\u65B9\u5757\u5904\u7406","children":[]}]},{"level":2,"title":"\u6E90\u7801","slug":"\u6E90\u7801","link":"#\u6E90\u7801","children":[]}],"relativePath":"games/parkour.md"}'),ds={name:"games/parkour.md"},Es=Object.assign(ds,{setup(p){return(o,l)=>(q(),R("div",null,[us,z(bs),ms]))}});export{ws as __pageData,Es as default};
